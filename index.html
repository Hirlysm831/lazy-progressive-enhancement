<!doctype html>
<html>
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="initial-scale=1.0, width=device-width">
   <title>Lazy Progressive Enhancement</title>
   <script src="lazy-progressive-enhancement.js"></script>
   <link rel="stylesheet" type="text/css" href="index.css">
</head>

<body>
   <section class="center">
      <a class="title-link" href="."><h1>Lazy Progressive Enhancement</h1></a>
      <p><a href="https://github.com/tvler/lazy-progressive-enhancement">Available on Github</a>, <a href="http://tylerdeitz.co/">built by Tyler</a></p>
      <p>A lazy image loader designed to enforce progressive enhancement and valid HTML.</p>
      <p>Not a framework,<br>
      not a library,<br>
      just a function.</p>
      <pre id="sample-function">loadMedia (
   element,
   onload,
   scroll
)</pre>
      <p><strong class="inline">element</strong>: CSS String | NodeList | Element</p>
      <p><strong class="inline">onload</strong>: Function (optional)</p>
      <p><strong class="inline">scroll</strong>: Boolean (optional) â€“ loads image when visible</p>
   </section>

   <section class="center">
      <a class="title-link" href="#content" id="content"><h2>Contents</h2></a>
      <ul id="contents">
         <li><a href='#basic'>Basic usage</a>
         <li><a href='#benefits'>Benefits of lazy-progressive-enhancement.js</a>
         <li><a href='#load'>Load specific images</a>
         <li><a href='#onload'>onload function</a>
         <li><a href='#scroll'>Scroll-based loading</a>
      </ul>
   </section>

   <section>
      <a href="#basic" class="title-link" id="basic"><h2>Basic Usage</h2></a>
      <p>Declare a lazy image like this:</p>
      <pre>&lt;noscript&gt;
  &lt;img src="..."&gt;
&lt;/noscript&gt;</pre>
      <figure>
         <noscript class="ex-1"><img alt="lazyloading image" src="img/img1.gif"/></noscript>
      </figure>
      <div class="inline output">
         <strong>Run:</strong>
         <div class="nowrap">
            <pre class="inline">loadMedia()</pre><a data-run="ex-1" class="js-run">Run</a>
         </div>
         <strong>Output:</strong>
         <pre class="inline">&lt;img src="..."&gt;</pre>
      </div>
      <p>By default, the function targets every <i>noscript</i> element on the page.</p>
      <p>Any attributes the noscript image has (<i>srcset</i>, <i>class</i>, <i>id</i>, <i>alt</i>, etc) are kept.</p>
   </section>

   <section>
      <a href="#benefits" class="title-link" id="benefits"><h2>Benefits of lazy-progressive-enhancement.js</h2></a>
      <ul>
         <li>Designed to enforce progressive enhancement and valid HTML.
         <li>Written in pure JS -- no dependencies.
         <li>Not a framework, not a library, just a function.
         <li>Also works on iframes.
      </ul>
      <p>Most lazyloaders work by the user specifying an image's source file in a data-attribute, which sets its src after a page is loaded.</p>
      <p>This is invalid HTML and breaks for users who don't have a javascript-enabled browser.</p>
   </section>

   <section>
      <a href="#load" class="title-link" id="load"><h2>Load Specific images</h2></a>
      <p>You can specify what images to load by passing a parameter into <i>loadMedia</i> of either</p>
      <ol>
         <li>A CSS selector string (use if calling the function before <i>DOMContentLoaded</i>)
         <li>A NodeList of <i>noscript</i>s (from something like <i>document.querySelectorAll</i>)
         <li>A singular <i>noscript</i> Element (from something like <i>document.querySelector</i>)
      </ol>
      <strong>Ex:</strong>
      <pre>&lt;noscript id="this-one"&gt;
   &lt;img src="..."&gt;
&lt;/noscript&gt;

&lt;noscript id="that-one"&gt;
   &lt;img src="..."&gt;
&lt;/noscript&gt;</pre>
      <div class="fig-col">
         <figure>
            <noscript class="ex-2"><img alt="lazyloading image" src="img/img6.gif"></noscript>
         </figure>
         <figure>
            <noscript class="ex-3"><img alt="lazyloading image" src="img/img3.gif"></noscript>
         </figure>
      </div>
      <div class="inline output">
         <strong>Run:</strong>
         <div class="nowrap">
            <pre class="inline">loadMedia('#this-one')</pre><a data-run="ex-2" class="js-run">Run</a>
         </div>
         <strong>Output:</strong>
         <pre class="inline">&lt;img src="..."&gt;

&lt;noscript id="that-one"&gt;
   &lt;img src="..."&gt;
&lt;/noscript&gt;</pre>

         <strong>Run:</strong>
         <div class="nowrap">
            <pre class="inline">loadMedia('#that-one')</pre><a data-run="ex-3" class="js-run">Run</a>
         </div>
         <strong>Output:</strong>
         <pre class="inline">&lt;img src="..."&gt;
&lt;img src="..."&gt;</pre>
      </div>
   </section>

   <section>
      <a href="#onload" class="title-link" id="onload"><h2>onload function</h2></a>
      <p>You can hook an onload function for every loaded image.</p>
      <p>This may help animate the image by styling it onload.</p>
      <strong>Run:</strong>
      <pre>loadMedia('#this-one', () => {
  this.classList.add('loaded');
);</pre>
      <strong>Output:</strong>
      <pre>&lt;img class="loaded" src="..."&gt;
&lt;noscript id="not-this-one"&gt;
   &lt;img src="..."&gt;
&lt;/noscript&gt;</pre>
   </section>

   <section>
      <a href="#scroll" class="title-link" id="scroll"><h2>Scroll-based loading</h2></a>
      <p>There's a default function to load images when they're scrolled into view.</p>
      <p>This is a general solution, creating your own scroll-based loading functionality may be more performant.</p>
      <p>Will be updated to use <a href="https://github.com/WICG/IntersectionObserver">Intersection observers</a> when it becomes standardized.
      <strong>Ex:</strong>
      <pre>loadMedia(null, null, true)</pre>
      <figure>
         <noscript class="ex-4"><img alt="lazyloading image" src="img/img10.gif"></noscript>
      </figure>
      <figure>
         <noscript class="ex-4"><img alt="lazyloading image" src="img/img5.gif"></noscript>
      </figure>
      <figure>
         <noscript class="ex-4"><img alt="lazyloading image" src="img/img2.gif"></noscript>
      </figure>
      <figure>
         <noscript class="ex-4"><img alt="lazyloading image" src="img/img7.gif"></noscript>
      </figure>
      <figure>
         <noscript class="ex-4"><img alt="lazyloading image" src="img/img8.gif"></noscript>
      </figure>
      <figure>
         <noscript class="ex-4"><img alt="lazyloading image" src="img/img9.gif"></noscript>
      </figure>
   </section>

<script>
   for(var i = 0, run = document.querySelectorAll('[data-run]'); i < run.length; i++) {
      run[i].onclick = (function() {
         loadMedia('.' + this.dataset.run);
      });
   }
   loadMedia('.ex-4', null, true);
</script>
</body>
